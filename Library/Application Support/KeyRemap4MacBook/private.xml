<?xml version="1.0"?>
<root>
  <item>
    <name>Delta Force</name>
    <item>
      <name>Hold D and F, then press:</name>

      <appendix></appendix>
      <appendix>In iTerm:</appendix>
      <appendix>* H/J/K/L/; to switch to Vim/Tmux pane left/down/up/right/most recent</appendix>
      <appendix>* I/O to switch to prev/next Vim tab</appendix>
      <appendix>* M/,/' to switch to prev/next/most recent Tmux window</appendix>
      <appendix>(These keystrokes actually map to F13-F19, and depend on Vim, Tmux and iTerm</appendix>
      <appendix>playing along. iTerm's default keymappings do their part out of the box.)</appendix>
      <appendix></appendix>

      <appendix>In Chrome:</appendix>
      <appendix>* I/O to switch to prev/next tab</appendix>
      <appendix>* M/, to switch to prev/next window</appendix>
      <appendix></appendix>

      <appendix>In OmniFocus:</appendix>
      <appendix>* H/L to switch between the sidebar and the main pane</appendix>
      <identifier vk_config="true">notsave.private.deltaforce</identifier>
      <autogen>__ShowStatusMessage__ Delta Force</autogen>

      <group>
        <only>iTerm</only>
        <autogen>__KeyToKey__ KeyCode::H, KeyCode::F13</autogen>
        <autogen>__KeyToKey__ KeyCode::J, KeyCode::F14</autogen>
        <autogen>__KeyToKey__ KeyCode::K, KeyCode::F15</autogen>
        <autogen>__KeyToKey__ KeyCode::L, KeyCode::F16</autogen>
        <autogen>__KeyToKey__ KeyCode::SEMICOLON, KeyCode::F17</autogen>

        <!-- Prev/Next Vim tab -->
        <autogen>__KeyToKey__ KeyCode::I, KeyCode::F18</autogen>
        <autogen>__KeyToKey__ KeyCode::O, KeyCode::F19</autogen>

        <!-- Prev/Next/Last Tmux window -->
        <!-- Switching to shifted F-keys here because KeyRemap4MacBook doesn't
             recognize anything above F19. But shifted F-keys are hard to get
             through Tmux to Vim. We can use them for these mappings because they
             don't have to get through to Vim, just to Tmux. -->
        <autogen>__KeyToKey__ KeyCode::M, KeyCode::F8, ModifierFlag::SHIFT_L</autogen>
        <autogen>__KeyToKey__ KeyCode::COMMA, KeyCode::F9, ModifierFlag::SHIFT_L</autogen>
        <autogen>__KeyToKey__ KeyCode::QUOTE, KeyCode::F10, ModifierFlag::SHIFT_L</autogen>
      </group>

      <appdef>
        <appname>Google Chrome</appname>
        <equal>com.google.Chrome</equal>
      </appdef>

      <group>
        <only>Google Chrome</only>
        <autogen>__KeyToKey__ KeyCode::I, KeyCode::BRACKET_LEFT,  ModifierFlag::SHIFT_L | ModifierFlag::COMMAND_L</autogen>
        <autogen>__KeyToKey__ KeyCode::O, KeyCode::BRACKET_RIGHT, ModifierFlag::SHIFT_L | ModifierFlag::COMMAND_L</autogen>

        <autogen>__KeyToKey__ KeyCode::M,     KeyCode::BACKQUOTE, ModifierFlag::COMMAND_L | ModifierFlag::SHIFT_L</autogen>
        <autogen>__KeyToKey__ KeyCode::COMMA, KeyCode::BACKQUOTE, ModifierFlag::COMMAND_L</autogen>
      </group>

      <group>
        <only>OmniFocus</only>
        <!-- There are only two "panes" in OmniFocus——the sidebar and the main
             pane——and there's only one way to switch between them. -->
        <autogen>__KeyToKey__ KeyCode::H,         KeyCode::KEY_4, ModifierFlag::COMMAND_L</autogen>
        <autogen>__KeyToKey__ KeyCode::L,         KeyCode::KEY_4, ModifierFlag::COMMAND_L</autogen>
        <autogen>__KeyToKey__ KeyCode::SEMICOLON, KeyCode::KEY_4, ModifierFlag::COMMAND_L</autogen>
      </group>

      <include path="null_mapping.xml"/>
    </item>

    <item>
      <name>Holding [D+F] turns on "Delta Force" mode</name>
      <identifier>remap.deltaforce_df</identifier>
      <autogen>__SimultaneousKeyPresses__ KeyCode::D, KeyCode::F, KeyCode::VK_CONFIG_SYNC_KEYDOWNUP_notsave_private_deltaforce</autogen>
    </item>
  </item>

  <item>
    <name>Speed Dial</name>
    <item>
      <name>Hold S and D, then press another key to switch to the application assigned to it.</name>
      <appendix>Some applications will hide when their key is pressed if they're</appendix>
      <appendix>already frontmost. This varies accordiong to how useful it is.</appendix>
      <appendix>See comments in private.xml, where the mappings are defined.</appendix>
      <identifier vk_config="true">notsave.private.speeddial</identifier>
      <autogen>__ShowStatusMessage__ Speed Dial</autogen>

      <autogen>__KeyToKey__ KeyCode::L, ModifierFlag::NONE, KeyCode::L, ModifierFlag::CONTROL_L | ModifierFlag::OPTION_L | ModifierFlag::COMMAND_L</autogen>
      <autogen>__KeyToKey__ KeyCode::N, ModifierFlag::NONE, KeyCode::N, ModifierFlag::CONTROL_L | ModifierFlag::OPTION_L | ModifierFlag::COMMAND_L</autogen>

      <autogen>__KeyToKey__ KeyCode::H, ModifierFlag::NONE, KeyCode::VK_NONE</autogen>

      <include path="speed_dial_app.xml">
        <replacementdef>
          <replacementname>KEY</replacementname>
          <replacementvalue>O</replacementvalue>
        </replacementdef>
        <replacementdef>
          <replacementname>APP_NAME</replacementname>
          <replacementvalue>OmniFocus</replacementvalue>
        </replacementdef>
        <replacementdef>
          <replacementname>APP_BUNDLE_ID</replacementname>
          <replacementvalue>com.omnigroup.OmniFocus</replacementvalue>
        </replacementdef>
        </include>

        <include path="speed_dial_app.xml">
        <replacementdef>
          <replacementname>KEY</replacementname>
          <replacementvalue>P</replacementvalue>
        </replacementdef>
        <replacementdef>
          <replacementname>APP_NAME</replacementname>
          <replacementvalue>Pandora</replacementvalue>
        </replacementdef>
        <replacementdef>
          <replacementname>APP_BUNDLE_ID</replacementname>
          <replacementvalue>com.fluidapp.FluidApp.Pandora</replacementvalue>
        </replacementdef>
        <replacementdef>
          <replacementname>APP_PATH</replacementname>
          <replacementvalue>/Applications</replacementvalue>
        </replacementdef>
      </include>

      <include path="speed_dial_app.xml">
        <replacementdef>
          <replacementname>KEY</replacementname>
          <replacementvalue>J</replacementvalue>
        </replacementdef>
        <replacementdef>
          <replacementname>APP_NAME</replacementname>
          <replacementvalue>iTerm</replacementvalue>
        </replacementdef>
        <replacementdef>
          <replacementname>APP_BUNDLE_ID</replacementname>
          <replacementvalue>com.googlecode.iterm2</replacementvalue>
        </replacementdef>
        <replacementdef>
          <replacementname>HIDE_KEY</replacementname>
          <replacementvalue>KeyCode::VK_NONE</replacementvalue>
        </replacementdef>
      </include>

      <include path="speed_dial_app.xml">
        <replacementdef>
          <replacementname>KEY</replacementname>
          <replacementvalue>K</replacementvalue>
        </replacementdef>
        <replacementdef>
          <replacementname>APP_NAME</replacementname>
          <replacementvalue>Google Chrome</replacementvalue>
        </replacementdef>
        <replacementdef>
          <replacementname>APP_BUNDLE_ID</replacementname>
          <replacementvalue>com.google.Chrome</replacementvalue>
        </replacementdef>
        <replacementdef>
          <replacementname>APP_PATH</replacementname>
          <replacementvalue>/Applications</replacementvalue>
        </replacementdef>

        <!--
          Sometimes, when Chrome is hidden and then activated with Speed
          Dial, it restores one of its minimized windows. It appears to be a
          bug in Chrome. To avoid that, we disable the hiding part of Speed
          Dial for Chrome, so we never hide it.
        -->
        <replacementdef>
          <replacementname>HIDE_KEY</replacementname>
          <replacementvalue>KeyCode::VK_NONE</replacementvalue>
        </replacementdef>
      </include>

      <include path="speed_dial_app.xml">
        <replacementdef>
          <replacementname>KEY</replacementname>
          <replacementvalue>SEMICOLON</replacementvalue>
        </replacementdef>
        <replacementdef>
          <replacementname>APP_NAME</replacementname>
          <replacementvalue>Flint</replacementvalue>
        </replacementdef>
        <replacementdef>
          <replacementname>APP_BUNDLE_ID</replacementname>
          <replacementvalue>com.giantcomet.flint</replacementvalue>
        </replacementdef>
        <replacementdef>
          <replacementname>APP_PATH</replacementname>
          <replacementvalue>/Applications</replacementvalue>
        </replacementdef>
      </include>


      <include path="null_mapping.xml"/>
    </item>
    <item>
      <name>Holding [D+F] turns on "Speed Dial" mode</name>
      <identifier>remap.speeddial_sd</identifier>
      <autogen>__SimultaneousKeyPresses__ KeyCode::S, KeyCode::D, KeyCode::VK_CONFIG_SYNC_KEYDOWNUP_notsave_private_speeddial</autogen>
    </item>
  </item>
</root>
